3.å»ºç­‘æ–°è£…å¤‡
æ§åˆ¶å™¨å‡çº§åï¼Œå¯è§£é”ä¸€äº›è£…å¤‡ï¼Œå¦‚wallsï¼ˆå¢™ï¼‰, rampartsï¼ˆé˜²å¾¡åœŸå¢™ï¼‰, and extensionsï¼ˆå»¶ä¼¸ï¼‰
extensionså…è®¸åˆ¶é€ æ›´å¤§çš„creep
ä¸€ä¸ªcreepåªæœ‰ä¸€ç§typeçš„workæ—¶ï¼Œå·¥ä½œå¾—å¾ˆå·®
å¦‚æœä¸€ä¸ªcreepæºå¸¦å¤šç§WORK TYPEï¼Œåˆ™èŠ±è´¹æ›´é«˜
ä¸€ä¸ªspawnæœ€å¤šåªèƒ½æœ‰300ç‚¹èƒ½é‡ï¼Œè¦å»ºé€ æ›´é«˜çº§çš„creepï¼Œéœ€è¦å…ˆå»ºé€ extensions

æ¯ä¸€çº§Controlleræœ‰å…è®¸æ„å»ºçš„extensionçš„ä¸ªæ•°ï¼Œçº§åˆ«è¶Šé«˜ï¼Œå…è®¸æ„å»ºæ•°è¶Šå¤š
extensionå¯ä»¥æ”¾åœ¨æˆ¿é—´ä»»æ„ä½ç½®ï¼Œspawnä½¿ç”¨extensionæ—¶ï¼Œæ— è§†è·ç¦»

structureä¹Ÿéœ€è¦creepæ¥å»ºé€ ï¼Œæ‰€ä»¥éœ€è¦ä¸“é—¨åšè¿™äº‹çš„creep
æ–°å»ºcreepæ—¶ï¼Œå¯ä»¥ä½¿ç”¨ç¬¬ä¸‰ä¸ªå‚æ•°æ¥è®¾å®šå…¶memory


Game.spawns['Spawn1'].spawnCreep( [WORK, CARRY, MOVE], 'Builder1',
    { memory: { role: 'builder' } } );

æ–°å»ºmodule  role.builder
var roleBuilder = {

    /** @param {Creep} creep **/
    run: function(creep) {

	    if(creep.memory.building && creep.carry.energy == 0) {
            creep.memory.building = false;
            creep.say('ğŸ”„ harvest');
	    }
	    if(!creep.memory.building && creep.carry.energy == creep.carryCapacity) {
	        creep.memory.building = true;
	        creep.say('ğŸš§ build');//creepçš„ä¼šè¯æ¡†
	    }

	    if(creep.memory.building) {
	        var targets = creep.room.find(FIND_CONSTRUCTION_SITES);//å¯»æ‰¾æœ€è¿‘çš„controller
            if(targets.length) {
                if(creep.build(targets[0]) == ERR_NOT_IN_RANGE) {//builderå…¶å®å°±æ˜¯æ³¨å…¥èƒ½é‡
                    creep.moveTo(targets[0], {visualizePathStyle: {stroke: '#ffffff'}});//ä¸ºè·¯çº¿å¯è§†åŒ–
                }
            }
	    }
	    else {
	        var sources = creep.room.find(FIND_SOURCES);//å¯»æ‰¾æœ€è¿‘çš„æº
            if(creep.harvest(sources[0]) == ERR_NOT_IN_RANGE) {
                creep.moveTo(sources[0], {visualizePathStyle: {stroke: '#ffaa00'}});
            }
	    }
	}
};

module.exports = roleBuilder;

å³ï¼Œä¸ºä¸€ä¸ªcreepåˆ†é…2ç§å·¥ä½œï¼Œé€šè¿‡flagæ¥åˆ‡æ¢ï¼Œï¼Œæ˜¯å¦building

mainï¼š
var roleHarvester = require('role.harvester');
var roleBuilder = require('role.builder');

module.exports.loop = function () {

    for(var name in Game.creeps) {
        var creep = Game.creeps[name];
        if(creep.memory.role == 'harvester') {
            roleHarvester.run(creep);
        }
        if(creep.memory.role == 'builder') {
            roleBuilder.run(creep);
        }
    }
}


creepä¸ä»…éœ€è¦èƒ½èƒ½é‡é€å›spawnï¼Œä¹Ÿè¦æŠŠèƒ½é‡é€åˆ°struct
var roleHarvester = {

    /** @param {Creep} creep **/
    run: function(creep) {
	    if(creep.carry.energy < creep.carryCapacity) {//æ”¶é›†èƒ½é‡
            var sources = creep.room.find(FIND_SOURCES);
            if(creep.harvest(sources[0]) == ERR_NOT_IN_RANGE) {
                creep.moveTo(sources[0], {visualizePathStyle: {stroke: '#ffaa00'}});
            }
        }
        else {
            var targets = creep.room.find(FIND_STRUCTURES, {//å¯»æ‰¾target
                    filter: (structure) => { //è¿‡æ»¤å™¨ï¼Œ
                        return (structure.structureType == STRUCTURE_EXTENSION || structure.structureType == STRUCTURE_SPAWN) &&
                            structure.energy < structure.energyCapacity;
                    }
            });
            if(targets.length > 0) {
                if(creep.transfer(targets[0], RESOURCE_ENERGY) == ERR_NOT_IN_RANGE) {
                    creep.moveTo(targets[0], {visualizePathStyle: {stroke: '#ffffff'}});//moveToä¼šé˜»å¡è¿è¡Œåˆ°åˆ°è¾¾ç›®æ ‡èŠ‚ç‚¹ï¼Ÿ
                }
            }
        }
	}
};

module.exports = roleHarvester;



å¾—åˆ°roomä¸­æ‰€æœ‰èƒ½é‡ç‚¹çš„æ•°å€¼ï¼š
var roleHarvester = require('role.harvester');
var roleBuilder = require('role.builder');

module.exports.loop = function () {

    for(var name in Game.rooms) {
        console.log('Room "'+name+'" has '+Game.rooms[name].energyAvailable+' energy');//æ‰“å°roomå†…è¿˜æœ‰å¤šå°‘èƒ½é‡
    }

    for(var name in Game.creeps) {
        var creep = Game.creeps[name];
        if(creep.memory.role == 'harvester') {
            roleHarvester.run(creep);
        }
        if(creep.memory.role == 'builder') {
            roleBuilder.run(creep);
        }
    }
}

æ„å»ºè¶…å¼ºçš„creepï¼šéœ€è¦550ç‚¹èƒ½é‡
Game.spawns['Spawn1'].spawnCreep( [WORK,WORK,WORK,WORK,CARRY,MOVE,MOVE],
    'HarvesterBig',
    { memory: { role: 'harvester' } } );

é€šè¿‡å°‘æ•°å‡ ä¸ªå¤§çš„creepæ¥æ›¿æ¢å¤šä¸ªå°çš„creepï¼Œå¯èŠ‚çº¦CPUæ—¶é—´

ä¸‹ä¸€èŠ‚å°†è®²è¿°å¦‚ä½•æ„å»ºè‡ªåŠ¨ç”Ÿäº§çš„creep
